<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="talk">
	<select id="findChatIdByMemberId" resultType="string">
		select chatid from chatroom
		where status = 'Y' and memberid = #{memberId}
	</select>
	<insert id="insertChatRoom">
		insert into chatroom(chatid, memberid)
		values(#{chatId}, #{memberId})
	</insert>
	<insert id="insertChatLog">
		insert into chatlog(chatno, chatid, memberid, msg, time)
		values(seq_chatlog.nextval, #{chatId}, #{memberId}, #{msg}, #{time})
	</insert>
	<update id="updateLastCheck">
		update chatroom set lastcheck = #{time}
		where chatid = #{chatId} and memberid = #{memberId}
	</update>
	<select id="findChatListByChatId" resultType="msg">
		select * 
		from chatlog
		where chatid = #{chatId}
		order by chatno
	</select>
	
</mapper>